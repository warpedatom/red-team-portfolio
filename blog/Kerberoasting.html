<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kerberoasting | Velkris Red Team Blog</title>
  <link rel="stylesheet" href="../assets/css/style.css">
</head>

<body>
  <main style="max-width:800px;margin:3rem auto;padding:1rem;">
    <h1>Kerberoasting: Concept, Detection, and Defensive Controls</h1>
    <p><strong>Author:</strong> Velkris (Jared Perry)</p>
    <p><strong>Focus:</strong> Identity-based credential theft in Kerberos environments</p>

    <h2>Summary</h2>
    <p>Kerberoasting is an offline credential-theft technique that targets service accounts in Active Directory by requesting service tickets (TGS) for service principal names (SPNs), extracting the encrypted portion, and cracking it offline.</p>

    <h2>How it works (conceptual)</h2>
    <ul>
      <li>A client requests a service ticket (TGS) for an SPN from the Ticket Granting Service (TGS) using a valid Kerberos TGT.</li>
      <li>The TGS issues a ticket encrypted with the service account’s key.</li>
      <li>An attacker with the ticket copies the encrypted data and tries to recover the plaintext password offline using password-cracking techniques.</li>
    </ul>

    <p><strong>Key point:</strong> The attack does not require domain credentials beyond the ability to request service tickets; it becomes powerful when service accounts have weak passwords or poor rotation practices.</p>

    <h2>Defensive detection signals</h2>
    <ul>
      <li>High volume of TGS requests from many distinct SPNs originating from a single account or host.</li>
      <li>Unusual TGS requests outside normal usage patterns (time of day, source host).</li>
      <li>Repeated Kerberos error events (abnormal replay/misuse).</li>
      <li>Windows event IDs: 4768/4769 anomalies, authentication anomalies, and privileged account activity.</li>
      <li>SIEM detection: watch for enumeration-like behavior (many TGS requests without corresponding connections).</li>
    </ul>

    <h2>Mitigations & Hardening</h2>
    <ul>
      <li>Enforce strong, unique service-account passwords and rotate them frequently.</li>
      <li>Avoid using domain or high-privilege accounts for service usage.</li>
      <li>Disable unused SPNs.</li>
      <li>Implement PAM and least privilege for service accounts.</li>
      <li>Log and centralize Kerberos-related events.</li>
    </ul>

    <h2>Safe lab validation (non-actionable)</h2>
    <ul>
      <li>Build isolated AD test environments with SPNs and service accounts.</li>
      <li>Simulate TGS request patterns in lab (without exploit/cracking tools in production).</li>
      <li>Ensure SIEM rules align with expected TGS volumes and baselines.</li>
    </ul>

    <h2>TL;DR</h2>
    <p>Kerberoasting exploits weak service-account passwords via offline cracking of Kerberos service tickets.  
    Mitigate with strong password hygiene, account hardening, and monitoring for abnormal TGS requests.</p>

    <footer style="margin-top:3rem;text-align:center;color:var(--muted);font-size:0.9rem;">
      <p>© 2025 Velkris | For educational and professional demonstration purposes only.</p>
    </footer>
  </main>
</body>
</html>
